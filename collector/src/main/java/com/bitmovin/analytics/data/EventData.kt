package com.bitmovin.analytics.data

import androidx.annotation.Keep
import com.bitmovin.analytics.api.CustomData
import com.bitmovin.analytics.utils.Util

@Keep // Protect from obfuscation in case customers are using proguard
data class EventData(
    val impressionId: String,
    val userId: String,
    val key: String?,
    val videoId: String?,
    val videoTitle: String?,
    val customUserId: String?,
    val path: String?,
    val cdnProvider: String?,
    val userAgent: String,
    val deviceInformation: DeviceInformationDto,
    val language: String,
    val analyticsVersion: String = Util.analyticsVersion,
    val playerTech: String,
    val domain: String,
    val screenHeight: Int,
    val screenWidth: Int,
    var autoplay: Boolean? = null,
    var isLive: Boolean = false,
    var isCasting: Boolean = false,
    var castTech: String? = null,
    var videoDuration: Long = 0,
    var time: Long = Util.timestamp,
    var videoWindowWidth: Int = 0,
    var videoWindowHeight: Int = 0,
    var droppedFrames: Int = 0,
    var played: Long = 0,
    var buffered: Long = 0,
    var paused: Long = 0,
    var ad: Int = 0,
    var adPosition: String? = null,
    var adId: String? = null,
    var adSystem: String? = null,
    var adIndex: Int? = null,
    var seeked: Long = 0,
    var videoPlaybackWidth: Int = 0,
    var videoPlaybackHeight: Int = 0,
    var videoBitrate: Int = 0,
    var audioBitrate: Int = 0,
    var videoTimeStart: Long = 0,
    var videoTimeEnd: Long = 0,
    var videoStartupTime: Long = 0,
    var duration: Long = 0,
    var startupTime: Long = 0,
    var state: String? = null,
    var errorCode: Int? = null,
    var errorMessage: String? = null,
    var errorData: String? = null,
    var playerStartupTime: Long = 0,
    var pageLoadType: Int = 1,
    var pageLoadTime: Int = 0,
    var version: String? = null,
    var streamFormat: String? = null,
    var mpdUrl: String? = null,
    var m3u8Url: String? = null,
    var progUrl: String? = null,
    var isMuted: Boolean = false,
    var sequenceNumber: Int = 0,
    val platform: String,
    var videoCodec: String? = null,
    var audioCodec: String? = null,
    var supportedVideoCodecs: List<String>? = null,
    var subtitleEnabled: Boolean = false,
    var subtitleLanguage: String? = null,
    var audioLanguage: String? = null,
    var drmType: String? = null,
    var drmLoadTime: Long? = null,
    var videoStartFailed: Boolean = false,
    var videoStartFailedReason: String? = null,
    var downloadSpeedInfo: DownloadSpeedInfo? = null,
    var retryCount: Int = 0,
    val player: String,
    var playerKey: String? = null,
    val customData1: String? = null,
    val customData2: String? = null,
    val customData3: String? = null,
    val customData4: String? = null,
    val customData5: String? = null,
    val customData6: String? = null,
    val customData7: String? = null,
    val customData8: String? = null,
    val customData9: String? = null,
    val customData10: String? = null,
    val customData11: String? = null,
    val customData12: String? = null,
    val customData13: String? = null,
    val customData14: String? = null,
    val customData15: String? = null,
    val customData16: String? = null,
    val customData17: String? = null,
    val customData18: String? = null,
    val customData19: String? = null,
    val customData20: String? = null,
    val customData21: String? = null,
    val customData22: String? = null,
    val customData23: String? = null,
    val customData24: String? = null,
    val customData25: String? = null,
    val customData26: String? = null,
    val customData27: String? = null,
    val customData28: String? = null,
    val customData29: String? = null,
    val customData30: String? = null,
    val experimentName: String? = null,
    // Field used to mark a sample that is ssai related as such
    // this is needed since ssai samples on live events
    // are globally synchronized in terms of when they are happening
    // and thus very spikey, this field is used to mark such samples
    // with a specific header when sending, which allows header
    // specific routing on load balancer side
    // we mark it as transient since we don't want to serialize this field
    @Transient
    var ssaiRelatedSample: Boolean = false,
) {
    constructor(
        deviceInfo: DeviceInformation,
        playerInfo: PlayerInfo,
        customData: CustomData,
        impressionId: String,
        userId: String,
        key: String?,
        videoId: String?,
        videoTitle: String?,
        customUserId: String?,
        path: String?,
        cdnProvider: String?,
        userAgent: String,
    ) : this(
        impressionId,
        userId,
        key,
        videoId,
        videoTitle,
        customUserId,
        path,
        cdnProvider,
        userAgent,
        DeviceInformationDto(
            deviceInfo.manufacturer,
            deviceInfo.model,
            deviceInfo.isTV,
            deviceInfo.operatingSystem,
            deviceInfo.operatingSystemMajor,
            deviceInfo.operatingSystemMinor,
            deviceInfo.deviceClass,
        ),
        deviceInfo.locale,
        playerTech = playerInfo.playerTech,
        domain = deviceInfo.domain,
        screenHeight = deviceInfo.screenHeight,
        screenWidth = deviceInfo.screenWidth,
        platform = Util.getPlatform(deviceInfo.isTV),
        player = playerInfo.playerType.toString(),
        customData1 = customData.customData1,
        customData2 = customData.customData2,
        customData3 = customData.customData3,
        customData4 = customData.customData4,
        customData5 = customData.customData5,
        customData6 = customData.customData6,
        customData7 = customData.customData7,
        customData8 = customData.customData8,
        customData9 = customData.customData9,
        customData10 = customData.customData10,
        customData11 = customData.customData11,
        customData12 = customData.customData12,
        customData13 = customData.customData13,
        customData14 = customData.customData14,
        customData15 = customData.customData15,
        customData16 = customData.customData16,
        customData17 = customData.customData17,
        customData18 = customData.customData18,
        customData19 = customData.customData19,
        customData20 = customData.customData20,
        customData21 = customData.customData21,
        customData22 = customData.customData22,
        customData23 = customData.customData23,
        customData24 = customData.customData24,
        customData25 = customData.customData25,
        customData26 = customData.customData26,
        customData27 = customData.customData27,
        customData28 = customData.customData28,
        customData29 = customData.customData29,
        customData30 = customData.customData30,
        experimentName = customData.experimentName,
    )
}
